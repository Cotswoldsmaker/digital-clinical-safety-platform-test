{% extends "base.html" %}

{% block main %}
<div style="height:20px"></div>
<details class="nhsuk-details nhsuk-expander">
  <summary class="nhsuk-details__summary">
    <span class="nhsuk-details__summary-text">
      How does this all work?
    </span>
  </summary>
  <div class="nhsuk-details__text">
    <p>The Clinical Safety Hazard Documentation (CSHD) app has been designed to 
      improved and simplifier the process of documentating the safe design and 
      implementation of digital health systems. CSHD uses a Django (python based)
      [link to further information]
      web app (the one you are using now) to collect details to initialise your
      clinical safety documents. You can then upload the initialised documents
      to Github and they documents can be viewed there.
      Once setup, you will be able to view the documents
      in an <b>mkdoc server</b> [need link to further info]. What you see on screen will
      be what is displayed on Github. If you need to update placeholders or the prose of
      the safety documents that can be done within the Django part of CSHD.
    </p>
  </div>
</details>

<legend class="nhsuk-fieldset__legend nhsuk-fieldset__legend--l">
  <h1 class="nhsuk-fieldset__heading">
    Initial Setup
  </h1>
</legend>


<script>
  function change_visibility() {
    var allElements = document.querySelectorAll('[id]');
    var installation_type = document.getElementById("id_installation_type").value;

    for (var i = 0; i < allElements.length; i++) {
        var element = allElements[i];
        
        if (element.id.endsWith("_SA") || element.id.endsWith("_I")) {
            element.style.display = "none";
        }
    }

    if (installation_type === 'SA') {
        for (var i = 0; i < allElements.length; i++) {
            var element = allElements[i];
            
            if (element.id.endsWith("_SA")) {
                element.style.display = "block";
            }
        }
    } 
    else if (installation_type === 'I') {
        for (var i = 0; i < allElements.length; i++) {
            var element = allElements[i];
            
            if (element.id.endsWith("_I")) {
                element.style.display = "block";
            }
        }
    } 
  };
</script>

<form action="/template_select" method="post">
    {% csrf_token %}

    {% for field in form %}
    <div class="nhsuk-form-group">
      <label class="nhsuk-label" for="id_{{ field.name }}" id="id_label_{{ field.name }}">
        {{ field.label }}
      </label>
      {{ field }}
    </div>
    {% endfor %}

    <button class="nhsuk-button" data-module="nhsuk-button" type="submit" style="float: right;">
      Submit
    </button>
  </form>

  <script>
    change_visibility();
  </script>
    
{% endblock %}